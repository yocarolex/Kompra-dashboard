<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Health Score - Customer Success</title>
<link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div class="container">
            <div class="header" style="display: flex; align-items: center; justify-content: space-between;">
    <div style="display: flex; align-items: center;">
        <img src="assets/img/logo.png" alt="Logo Kompra" style="width: 115px; height: 115px; object-fit: contain;">
        <div style="margin-left: 20px;">
            <h1 style="margin: 0; color: #F1F5F9; font-size: 3.0em;">HEALTH SCORE</h1>
        </div>
    </div>
    <div class="upload-section" style="display: flex; gap: 16px;">
        <div class="file-upload">
            <input type="file" id="excelFile" accept=".xlsx,.xls" />
            <label for="excelFile" class="file-upload-btn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M21.8,3H16.2C15.7,1.7 14.4,1 13,1H7C5.9,1 5,1.9 5,3V21C5,22.1 5.9,23 7,23H17C18.1,23 19,22.1 19,21V7L21.8,3M17,19H7V5H13V8H17V19M14.5,13.5L12.3,16.3L11.2,15.2L10.5,15.9L12.3,17.7L15.2,14.8L14.5,13.5Z"/>
                </svg>
                Carregar Excel
            </label>
        </div>
        <button class="btn-report" onclick="generateWeeklyReport()">
            üìà Relat√≥rio Semanal
        </button>
        <button class="btn-report danger" onclick="openRedFlagsPage()">
            üö´ Ver Red Flags
        </button>
    </div>
</div>

        <!-- Alertas -->
        <div id="alertsSection" class="alerts-section" style="display: none;">
            <h3 style="color: #F1F5F9;">üö® Red Flags Autom√°ticos</h3>
            <div id="alertsList"></div>
        </div>

        <!-- Estat√≠sticas Gerais -->
        <div class="stats-grid">
            <div class="stat-card fade-in">
                <div class="stat-number verde" id="verdeCount">0</div>
                <div class="stat-label">Clientes Verde</div>
                <div class="progress-bar">
                    <div class="progress-fill verde" id="verdeProgress"></div>
                </div>
            </div>
            <div class="stat-card fade-in">
                <div class="stat-number azul" id="azulCount">0</div>
                <div class="stat-label">Clientes Azul</div>
                <div class="progress-bar">
                    <div class="progress-fill azul" id="azulProgress"></div>
                </div>
            </div>
            <div class="stat-card fade-in">
                <div class="stat-number laranja" id="laranjaCount">0</div>
                <div class="stat-label">Clientes Laranja</div>
                <div class="progress-bar">
                    <div class="progress-fill laranja" id="laranjaProgress"></div>
                </div>
            </div>
            <div class="stat-card fade-in">
                <div class="stat-number vermelho" id="vermelhoCount">0</div>
                <div class="stat-label">Clientes Vermelho</div>
                <div class="progress-bar">
                    <div class="progress-fill vermelho" id="vermelhoProgress"></div>
                </div>
            </div>
        </div>

        <!-- Card de Resumo Semanal -->
        <div style="margin-bottom: 24px;">
            <!-- Linha 1: Totais -->
            <div class="stats-grid stats-totals" style="grid-template-columns: 1fr 1fr; margin-bottom: 16px;">
                <div class="stat-card summary-card fade-in" style="color: white;">
                    <div class="stat-number" id="totalPedidos" style="color: white; font-size: 2.4em;">0</div>
                    <div class="stat-label" style="color: rgba(255,255,255,0.9);">Total Pedidos no M√™s</div>
                </div>
                <div class="stat-card summary-card revenue fade-in" style="color: white;">
                    <div class="stat-number" id="totalTransacionado" style="color: white; font-size: 2.4em;">R$ 0</div>
                    <div class="stat-label" style="color: rgba(255,255,255,0.9);">Total Transacionado</div>
                </div>
            </div>
            
            <!-- Linha 2: M√©dias -->
            <div class="stats-grid stats-medias">
                <div class="stat-card summary-card economy fade-in" style="color: white;">
                    <div class="stat-number" id="mediaEconomia" style="color: white;">0%</div>
                    <div class="stat-label" style="color: rgba(255,255,255,0.9);">M√©dia de Economia</div>
                </div>
                <div class="stat-card summary-card suppliers fade-in" style="color: white;">
                    <div class="stat-number" id="mediaFornecedores" style="color: white;">0%</div>
                    <div class="stat-label" style="color: rgba(255,255,255,0.9);">M√©dia Fornecedores que n√£o Responderam</div>
                </div>
                <div class="stat-card summary-card performance fade-in" style="color: white;">
                    <div class="stat-number" id="mediaPerformance" style="color: white;">0%</div>
                    <div class="stat-label" style="color: rgba(255,255,255,0.9);">M√©dia de Performance</div>
                </div>
            </div>
        </div>

        <!-- Controles -->
        <div class="controls-section">
            <input type="text" class="search-box" id="searchBox" placeholder="üîç Buscar restaurante..." />
            <select class="filter-select" id="scoreFilter">
                <option value="">Todos os Scores</option>
                <option value="verde">Verde (85-100)</option>
                <option value="azul">Azul (70-84)</option>
                <option value="laranja">Laranja (50-69)</option>
                <option value="vermelho">Vermelho (0-49)</option>
            </select>
            <select class="filter-select" id="responsibleFilter">
                <option value="">Todos Respons√°veis</option>
                <option value="jo√£o">Jo√£o</option>
                <option value="gabriel">Gabriel</option>
                <option value="jessica">Jessica</option>
            </select>
        </div>

        <!-- Dashboard Principal -->
        <div class="dashboard-content">
            <!-- Tabela de Clientes -->
            <div class="clients-table-container">
                <h3>üçΩÔ∏è Lista de Restaurantes</h3>
                <div id="tableContainer">
                    <div class="no-data">
                        üìÅ Carregue um arquivo Excel para ver os dados dos restaurantes
                    </div>
                </div>
            </div>

            <div class="sidebar">
                <div class="chart-container">
                    <h3 class="chart-title">üìä Distribui√ß√£o por Score</h3>
                    <div id="scoreChart">
                        <div class="no-data">Aguardando dados...</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">‚ö†Ô∏è Alertas Ativos</h3>
                    <div id="alertsChart">
                        <div class="no-data">Nenhum alerta ativo</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Red Flags -->
    <div id="redFlagsModal" class="modal">
        <div class="modal-content-large">
            <div class="modal-header">
                <span class="close" onclick="closeRedFlagsModal()">&times;</span>
                <h3 style="color: #EF4444; margin: 0; font-size: 1.4em;">üö® Red Flags Autom√°ticos</h3>
            </div>
            
            <div class="modal-body">
                <!-- Filtro por Restaurante -->
                <div style="margin-bottom: 24px; padding: 20px; background: linear-gradient(135deg, #0F172A, #1E293B); border-radius: 12px; border: 1px solid #334155;">
                    <label for="restaurantFilter" style="display: block; margin-bottom: 10px; font-weight: 600; color: #F1F5F9;">
                        üîç Filtrar por Restaurante:
                    </label>
                    <select id="restaurantFilter" onchange="filterRedFlags()" style="width: 100%; padding: 12px; border: 2px solid #475569; border-radius: 8px; background: #0F172A; color: #E2E8F0;">
                        <option value="">üçΩÔ∏è Todos os Restaurantes</option>
                    </select>
                </div>

                <!-- Container dos Red Flags -->
                <div id="redFlagsContainer">
                    <div class="no-data">Carregando red flags...</div>
                </div>

                <!-- Resumo -->
                <div id="redFlagsSummary" style="margin-top: 24px; padding: 20px; background: linear-gradient(135deg, #F59E0B, #D97706); border-radius: 12px; color: white;">
                    <strong style="font-size: 1.1em;">üìä Resumo de Red Flags</strong>
                    <div id="summaryContent"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Detalhes de Alertas -->
    <div id="alertDetailsModal" class="modal">
        <div class="modal-content-large">
            <div class="modal-header">
                <span class="close" onclick="closeAlertDetailsModal()">&times;</span>
                <h3 id="alertDetailsTitle" style="color: #EF4444; margin: 0;">Detalhes do Alerta</h3>
            </div>
            
            <div class="modal-body">
                <div id="alertDetailsContent">
                    <div class="no-data">Carregando detalhes...</div>
                </div>
            </div>
        </div>
    </div>

   <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
   <script src="assets/js/main.js"></script>
</body>
</html>